#include <math.h>
#include <stdbool.h>
#include <stdio.h>
#include <stdlib.h>
#include <time.h>

#define MODULO 1000000007L

int maximizeSquareAreaOLD(int m, int n, int *hFences, int hFencesSize,
                          int *vFences, int vFencesSize) {
  if (m == n) {
    return ((long)(m - 1) * (n - 1)) % MODULO;
  }
  int longest_edge = m > n ? m : n;
  bool *h_differences = calloc(longest_edge, sizeof(bool));
  bool *v_differences = calloc(longest_edge, sizeof(bool));
  h_differences[m - 1] = true;
  v_differences[n - 1] = true;

  clock_t c1, c2;
  c1 = clock();
  for (int i = 0; i < hFencesSize; i++) {
    h_differences[hFences[i] - 1] = true;
    h_differences[m - hFences[i]] = true;
    for (int j = i + 1; j < hFencesSize; j++) {
      h_differences[abs(hFences[j] - hFences[i])] = true;
    }
  }
  printf("1 %ld\n", clock() - c1);

  c1 = clock();
  for (int i = 0; i < vFencesSize; i++) {
    v_differences[vFences[i] - 1] = true;
    v_differences[n - vFences[i]] = true;
    for (int j = i + 1; j < vFencesSize; j++) {
      v_differences[abs(vFences[j] - vFences[i])] = true;
    }
  }
  printf("2 %ld\n", clock() - c1);

  c1 = clock();
  for (long long i = longest_edge - 1; i >= 1; i--) {
    if (h_differences[i] && v_differences[i]) {
      printf("3 %ld\n", clock() - c1);
      free(h_differences);
      free(v_differences);
      return (i * i) % MODULO;
    }
  }

  return -1;
}

int maximizeSquareArea(int m, int n, int *hFences, int hFencesSize,
                       int *vFences, int vFencesSize) {
  if (m == n) {
    return ((long)(m - 1) * (n - 1)) % MODULO;
  }
  int longest_edge = m > n ? m : n;
  char *edges = calloc(longest_edge, sizeof(char));
  edges[m - 1]++;
  edges[n - 1]++;

  clock_t c1, c2;
  c1 = clock();
  for (int i = 0; i < hFencesSize; i++) {
    edges[hFences[i] - 1]++;
    edges[m - hFences[i]]++;
    for (int j = i + 1; j < hFencesSize; j++) {
      edges[abs(hFences[j] - hFences[i])]++;
    }
  }
  printf("1 %ld\n", clock() - c1);

  c1 = clock();
  for (int i = 0; i < vFencesSize; i++) {
    int vminus1 = vFences[i] - 1;
    int nminusv = n - vFences[i];
    edges[vminus1]++;
    edges[nminusv]++;
    for (int j = i + 1; j < vFencesSize; j++) {
      int vjminusvi = abs(vFences[j] - vFences[i]);
      edges[vjminusvi]++;

      if (edges[vjminusvi] >= 2) {
        printf("2 %ld\n", clock() - c1);
        return (((long)vjminusvi) * vjminusvi) % MODULO;
      }
    }
    if (edges[vminus1] >= 2) {
      printf("2 %ld\n", clock() - c1);
      return (((long)vminus1) * vminus1) % MODULO;
    }
    if (edges[nminusv] >= 2) {
      printf("2 %ld\n", clock() - c1);
      return (((long)nminusv) * nminusv) % MODULO;
    }
  }
  printf("2 %ld\n", clock() - c1);
  /*
    c1 = clock();
    for (long long i = longest_edge - 1; i >= 1; i--) {
      if (h_differences[i] && v_differences[i]) {
        printf("3 %ld\n", clock() - c1);
        free(h_differences);
        free(v_differences);
        return (i * i) % MODULO;
      }
    }
  */
  return -1;
}

int main(int argc, char **argv) {
  int m = 344229253, n = 955831948, hFencesSize = 600, vFencesSize = 600;
  int hFences[] = {
      77161711,  173186803, 249349546, 307033926, 262544557, 147896116,
      60658618,  51716468,  19715113,  31007640,  27104816,  287576340,
      57836172,  60564029,  148681353, 74852013,  166430677, 254961477,
      241197496, 25325226,  11162539,  216173172, 250970163, 78549043,
      222407631, 149677943, 131300908, 323877780, 201006078, 305999699,
      223129177, 73781799,  305628856, 187089510, 114040212, 136495263,
      104571000, 41218251,  64154410,  290612229, 6330028,   248391874,
      122656505, 256028324, 212751426, 134805626, 84858775,  68847379,
      153241424, 327643441, 77019996,  51182159,  93685285,  310894135,
      325626261, 340964937, 313530056, 257583905, 164897600, 64324472,
      148949124, 293422967, 141915648, 290178197, 289133089, 30309004,
      225245005, 51607486,  179993720, 117770492, 35361738,  78203821,
      231591854, 299000817, 96710335,  16968387,  173561897, 158230114,
      262125398, 184682233, 133243596, 280316340, 284115616, 165471323,
      247349988, 1272150,   27217708,  268654997, 335167945, 344175402,
      210206695, 92808163,  233677982, 290660887, 200729040, 70834898,
      155950725, 241980306, 185483711, 259127211, 13424793,  253010338,
      102596087, 136751361, 109201698, 94302693,  158883550, 265709722,
      144730235, 109607666, 14482843,  178609995, 270589924, 95188891,
      163573329, 38810473,  336979882, 314679528, 218485113, 98892087,
      39093290,  136072805, 141826905, 13020603,  297145773, 18190616,
      305468738, 236265321, 287351124, 80651911,  19877333,  266037192,
      54123753,  110335294, 257787340, 277846865, 227424502, 157623642,
      225589743, 183550568, 126341642, 151575676, 38944826,  231939496,
      109478682, 66777918,  187034529, 227082609, 319465091, 90279769,
      127975507, 48376730,  40019286,  211346872, 44682630,  173130507,
      161700789, 315936514, 235501547, 288406910, 272592485, 192613267,
      251955306, 236082527, 250485734, 235440382, 259441268, 125851282,
      204161750, 82821575,  76211952,  157069558, 133851879, 170419340,
      15680054,  258710500, 293515577, 298753184, 298335968, 282099219,
      191655218, 298778620, 33267262,  324936423, 54993671,  81742569,
      142145491, 307200185, 231547654, 226237307, 222270086, 142420266,
      286044092, 255216719, 297381442, 159823449, 114402872, 323178516,
      240705116, 315212648, 299150873, 219078757, 98448482,  280186082,
      145742542, 258972866, 147123205, 299873897, 77053926,  309774526,
      163649506, 80365322,  299345679, 141424930, 213445673, 141067997,
      117613402, 297551199, 322754000, 171707862, 248417675, 25818046,
      169273697, 162073900, 64853880,  270902646, 58182201,  209012674,
      138686092, 91210092,  163014017, 107266074, 27385882,  287859208,
      257338682, 179713535, 106685554, 121239377, 317702809, 137602505,
      168136725, 123713274, 343886617, 271072765, 126980759, 16785544,
      208763720, 266833023, 268629147, 297472335, 308818559, 98998938,
      65587144,  132643236, 237902463, 58181728,  100308388, 281203740,
      78517353,  45489445,  324196956, 67168826,  114160318, 179500102,
      80456521,  165201817, 343427054, 336252932, 36573562,  258538354,
      199553380, 236392705, 72202732,  264552674, 304105582, 192485343,
      51899268,  76992253,  141239594, 282497757, 311643130, 57264071,
      180938642, 142207357, 165405414, 294657187, 278001521, 255061355,
      110722970, 165214530, 14813834,  256958673, 25687499,  190184344,
      219710506, 63157878,  44981606,  261097409, 306635172, 175934631,
      14511072,  140301567, 84747367,  326196502, 175376311, 201212414,
      96929668,  33959005,  154561094, 136873154, 90960186,  168221404,
      30986932,  303117718, 25015705,  310807672, 231753237, 308868328,
      109436460, 271220398, 85773374,  63144581,  28413098,  43895474,
      12337478,  132911300, 123578051, 298249179, 19686202,  207177718,
      204818734, 248369878, 119627955, 164577719, 285043060, 148467932,
      271088905, 288817664, 41865906,  334066337, 161626029, 90698128,
      113241463, 181469888, 35550619,  22533579,  47908120,  329458319,
      300292753, 249275122, 264757882, 288468079, 183423214, 287029340,
      309920868, 47802136,  227978983, 10965284,  130081585, 156171504,
      85166714,  252467510, 105520734, 344196722, 281675315, 245814332,
      58929278,  274651478, 188138977, 87853751,  257009887, 199174862,
      161118893, 281441982, 135327935, 137003826, 212921813, 193411756,
      216966967, 35195007,  63384089,  44180781,  56540670,  310692186,
      184406135, 53967588,  83016480,  207514626, 329252591, 275136440,
      260821626, 211312322, 212550802, 31446246,  232654781, 235179445,
      4564469,   75307681,  34332191,  173559251, 120725325, 284926576,
      294902961, 59180799,  313036665, 316103757, 215447873, 280263755,
      115579650, 180055862, 213330363, 67793190,  97765339,  151745564,
      78836771,  294400586, 123008261, 270484357, 58905778,  174285833,
      232212568, 290032287, 204350800, 229848137, 37901590,  220178638,
      75071905,  11248684,  307237570, 282533416, 33569440,  166959999,
      202565414, 311009431, 58563676,  308877971, 23033754,  12187012,
      160695970, 25780152,  137759334, 39092887,  214736684, 7271615,
      199336336, 331801757, 342604406, 2768871,   225056064, 109777878,
      211555775, 304432272, 302764779, 197676558, 127766127, 52907316,
      172762387, 36191015,  107371188, 281247156, 291188506, 159091762,
      270472290, 33301851,  146873955, 139652276, 154456939, 152354772,
      298058890, 66599123,  113345624, 208455001, 246102062, 78875924,
      313489722, 180965944, 254974719, 245356557, 280833335, 238294247,
      330042803, 208954481, 58092266,  229376995, 302217662, 278060178,
      145858071, 159334659, 124733899, 136636759, 36807286,  235820946,
      69230506,  98727697,  47162677,  64266248,  219977009, 270001265,
      91925336,  26717151,  91273213,  300198929, 34207282,  150001796,
      301611848, 4657842,   312351953, 192900558, 335740384, 320544514,
      84343682,  194961776, 19197781,  98109912,  35271350,  62020788,
      31565052,  173630425, 120968787, 253145496, 241447563, 28473956,
      255933914, 74423860,  52261125,  210792148, 105597238, 224280391,
      173990611, 208881700, 288304067, 143905018, 182204490, 194122485,
      304148783, 341908782, 18520951,  166112921, 252486051, 259177060,
      263309851, 301036912, 77248927,  85033128,  300346615, 124569736,
      279003778, 240693225, 94590427,  151599179, 247173783, 117815679,
      111314541, 208697384, 73221876,  54654283,  328423875, 112771932,
      292094095, 326515329, 181652930, 232925754, 145228693, 81453697,
      176692239, 332773626, 248680098, 277118982, 32032197,  168728854,
      54744336,  180671125, 105634019, 66653215,  131821662, 335968177,
      276547814, 141856655, 149434952, 279211194, 325481759, 45561185,
      149889410, 19742450,  311836476, 118475443, 175069434, 33630248,
      12993269,  293092320, 103791356, 60992194,  307126988, 145716182,
      148033373, 269081311, 265256796, 180051670, 223398427, 332418927};
  int vFences[] = {
      625702715, 705834155, 151044085, 434579823, 936060304, 389730315,
      14268791,  174244895, 426869577, 477960579, 870124004, 422726392,
      562766700, 230447861, 696545172, 80089894,  52250837,  87174605,
      418014290, 663290226, 648115442, 300045155, 665200226, 429150824,
      644797683, 366362855, 10831921,  661543586, 463406015, 579202197,
      788640278, 645406420, 176306258, 685956076, 634539641, 697522021,
      228307288, 339243705, 56365710,  190268393, 848540439, 580681898,
      746426721, 321068295, 299927559, 904741584, 949118561, 330870003,
      726548223, 379275536, 56874531,  274975564, 847164847, 797489198,
      908697872, 504250604, 466996965, 182523936, 689949108, 260542028,
      643374475, 722991983, 345976745, 809728075, 650197256, 761200849,
      765571658, 95645542,  454725140, 279355499, 922687715, 77162835,
      347715580, 884317473, 55119285,  867991660, 944153271, 860634431,
      783351668, 615529823, 746598036, 48592349,  621758799, 904742132,
      257357872, 348003769, 522477768, 597799268, 48619441,  262269257,
      672907959, 718244049, 501679490, 765223309, 803214003, 897815496,
      746912708, 912451640, 330681341, 470398383, 614349712, 724716370,
      122288381, 422342957, 519754093, 840704283, 182778458, 617369036,
      301153165, 928167167, 229306159, 395206014, 65825410,  412063774,
      52514204,  739375919, 434332598, 601305896, 828856578, 454555618,
      624934672, 818851215, 814893981, 911505860, 443046483, 818415890,
      111683424, 301950908, 724637475, 410906844, 823926799, 815475661,
      569840490, 697975956, 783849966, 389895572, 21512329,  581884198,
      764514936, 152794439, 494853019, 177990585, 420214522, 801650084,
      599065989, 505711094, 771116098, 101014166, 929362948, 111307769,
      294874079, 15068560,  102678077, 401382330, 362855220, 256407664,
      390605906, 62448044,  689168186, 105485346, 754642368, 841668675,
      331034805, 400513157, 582312120, 373497355, 557362688, 711398675,
      738712515, 140427994, 882978427, 255734757, 429772544, 281871056,
      296356677, 930830546, 253982657, 169838020, 33214111,  76703269,
      914672626, 734904183, 738672499, 906633740, 688199924, 528809140,
      163253333, 891115801, 370967839, 809310450, 1567821,   750450813,
      746648650, 627997344, 731400450, 57387800,  953368347, 32227075,
      622619516, 30951603,  951284836, 646270501, 361211869, 359915058,
      33523977,  608768955, 593750374, 55987609,  923608514, 831108048,
      624189238, 437712612, 433258020, 448214608, 346292926, 746435126,
      776951422, 192891198, 388652616, 673010534, 732347100, 460178103,
      291557172, 546594002, 946185376, 180542183, 683365135, 180559481,
      936937221, 547190132, 313095093, 198312308, 851707335, 916843776,
      404325872, 768836827, 835903223, 63029401,  117935258, 728943074,
      163823957, 284741355, 826966887, 370182091, 326463226, 248273615,
      382072890, 865823778, 115116564, 792683546, 665437416, 382015454,
      943087626, 478682426, 666022893, 889379713, 773266640, 315691762,
      922079226, 311464661, 162407591, 126425322, 270820794, 317371040,
      761030099, 827645983, 697978060, 557910206, 661344677, 103424722,
      849420973, 455042070, 297681178, 296683063, 694797391, 546844515,
      419907390, 129950819, 834197889, 460660223, 599637044, 259338216,
      550628232, 273276193, 786146410, 728736325, 693362208, 666354369,
      786049947, 705740143, 771625030, 428782528, 282573932, 749681945,
      946763093, 195716309, 725781136, 484623881, 578367535, 380814986,
      30910352,  314596661, 599125714, 504592962, 908017745, 190322056,
      211475104, 892311125, 781010323, 916369366, 539143498, 238824842,
      201830523, 820083134, 808754428, 709130554, 378287212, 712819355,
      337920044, 681919387, 552551181, 264275523, 875190454, 276856964,
      598214936, 735051637, 414624728, 54920267,  841437406, 902732485,
      120149784, 719713887, 339741454, 880882978, 950652593, 929386799,
      469651580, 445047837, 528614622, 929550385, 697494593, 709711369,
      622552369, 598353808, 531466301, 689206732, 67079159,  227225616,
      877503265, 239428299, 604795157, 665644149, 85400742,  436741145,
      765157594, 566722688, 664249637, 113650307, 429332715, 593132982,
      630719476, 182610028, 681628427, 495674024, 456582469, 254762239,
      863821654, 525127616, 641273236, 118141353, 93016435,  577768831,
      793307130, 945816755, 56468865,  753915736, 582097060, 576788709,
      315978436, 140504209, 59306672,  216008493, 452169018, 798601761,
      929723801, 495663937, 889314137, 488371889, 664371679, 671106224,
      446504205, 275602129, 822262077, 777483305, 464418634, 392299513,
      587344162, 111521473, 196975861, 133391381, 473348874, 444343354,
      386747333, 211297541, 602253519, 298341976, 742632232, 414902656,
      315187089, 9148397,   370298815, 719940692, 561562247, 852227699,
      18602805,  78983388,  856938481, 295268353, 379208823, 811275027,
      507742202, 417196120, 441258055, 652521885, 36034668,  658287603,
      811561291, 645775357, 879402631, 505765855, 18048185,  614350757,
      548368668, 392471627, 720598547, 493641553, 44033865,  208328577,
      499589394, 317202435, 679195013, 141843338, 30284788,  950084464,
      312248576, 411346661, 192269046, 294377832, 918308360, 877371860,
      678991304, 908859133, 629504472, 189533180, 476170648, 784316279,
      109313635, 715581470, 570585205, 157757110, 843126267, 12938688,
      315778772, 164977780, 309060661, 137921299, 30830380,  728244154,
      722991514, 697032283, 486797569, 705920961, 365583110, 884014904,
      699960196, 850883782, 562488608, 628913599, 502353915, 711664058,
      113750349, 671759909, 953647294, 451462590, 395287628, 889305275,
      203643945, 137469008, 144674340, 168643219, 724741160, 65074938,
      51421427,  481389243, 813626268, 417748515, 912486203, 271650418,
      778042733, 546727457, 760816635, 44467516,  420473949, 140837130,
      583977438, 145869310, 743982954, 753769582, 391676702, 384096659,
      885467664, 592614906, 201390730, 238463187, 48833846,  905391639,
      598516632, 904935178, 580716488, 499476505, 939697127, 231274101,
      863279313, 350494488, 575474415, 948876468, 601815905, 162340921,
      932039361, 333035592, 515038393, 546234280, 863314827, 193885557,
      918714320, 612616654, 378980134, 90709779,  69518067,  210560754,
      851870490, 481726179, 282677941, 288618940, 344935168, 645249429,
      897042191, 115422154, 184294508, 101634835, 115751447, 896856726,
      813199763, 660219437, 533921248, 108280212, 448785985, 755649950,
      752034565, 572234489, 519388573, 438914557, 186763176, 712625165,
      458506449, 512065510, 342487274, 709913442, 186082196, 326983666,
      912987884, 434908005, 64966874,  292228494, 936126382, 240501870,
      874950115, 694247604, 263532029, 31594783,  436270236, 105795750,
      440765410, 858788199, 822784361, 540368819, 794859860, 335159263,
      626571894, 564513930, 659225505, 920485906, 403167202, 2546082,
      122368382, 401423639, 246609871, 98796172,  415539989, 23533508};

  int result =
      maximizeSquareArea(m, n, hFences, hFencesSize, vFences, vFencesSize);

  printf("%d\n", result);

  return 0;
}
